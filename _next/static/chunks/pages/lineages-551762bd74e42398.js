(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[238],{7383:(e,t,i)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/lineages",function(){return i(7755)}])},1182:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var a=i(4848),n=i(637),r=i(3502),o=i(6540);let s=(0,o.forwardRef)(function(e,t){let i=(0,o.useRef)(null);return(0,o.useEffect)(()=>{let e=t,a=()=>{i.current=(0,r.i)(e.current,{opacity:[0,1]},{duration:.6,ease:"easeInOut"})};return e.current&&(e.current.complete?a():e.current.addEventListener("load",a)),()=>{e.current.removeEventListener("load",a),i.current?.cancel()}},[]),(0,a.jsx)(n.A,{style:{opacity:0},ref:e=>{t={current:e}},...e})})},3468:(e,t,i)=>{"use strict";i.d(t,{F:()=>c});var a=i(4848),n=i(2428),r=i(6540),o=i(9946);let s=()=>{let e=(0,r.useRef)(null);return(0,a.jsx)(o._,{elementRef:e})};var l=i(1109),d=i.n(l);let c=(0,r.memo)(function(){return(0,a.jsx)("div",{className:d().SmokeCanvas,children:(0,a.jsx)(n.Hl,{children:(0,a.jsx)(s,{})})})})},7755:(e,t,i)=>{"use strict";i.r(t),i.d(t,{__N_SSG:()=>z,default:()=>B});var a=i(4848),n=i(8546),r=i(1133);i(9703);var o=i(6540),s=i(1182);let l={"WNhh_0kvSR2066RpvkajIw-SBz8nKYdRq2ZO_JkIWSGLQ":{origin:"Uther",sourcePosition:"RIGHT",targetPosition:"LEFT"},"DCTXEv07QgSy3Wz2WrBxdA-ajVGRHYZQ229TrplAeYViA":{origin:"Taliesin",sourcePosition:"RIGHT",targetPosition:"LEFT"},"DCTXEv07QgSy3Wz2WrBxdA-e2majSsDQrqcgO4KCExNnA":{origin:"Taliesin",sourcePosition:"RIGHT",targetPosition:"TOP"},"ajVGRHYZQ229TrplAeYViA-e2majSsDQrqcgO4KCExNnA":{origin:"Charis",sourcePosition:"LEFT",targetPosition:"TOP"}};var d=i(5678),c=i(4164),g=i(3295),u=i(104),h=i(8343),m=i(3502),y=i(8823),f=i(2863),p=i.n(f),b=i(8848),_=i(637);function w(){let e=(0,r.Pj)(e=>e.edges),t=(0,r.Pj)(e=>e.setEdges),i=(0,o.useRef)(null),a=(0,o.useRef)(!1),n=(0,o.useCallback)(i=>{if(!i){t(e.map(e=>({...e,className:p().edgeDefault})));return}t(e.map(e=>{let t=e.source===i||e.target===i,n=a.current?p().edgeConnected:p().edgeReconnected;return{...e,className:t?n:p().edgeHidden}}))},[e,t]);return(0,o.useEffect)(()=>{let e=d.k.subscribe(e=>{let{hoveringCharacter:t}=e;t!==i.current&&(t&&(a.current=!a.current),i.current=t),n(t)});return()=>e()},[n]),null}var x=i(6298),v=i(6715);let k=({nodes:e})=>{let t=(0,v.useRouter)(),{fitBounds:i}=(0,r.VH)(),{clan:a}=t.query;return(0,o.useEffect)(()=>{if(!a||"string"!=typeof a)return;let t=e.find(e=>"clan"===e.type&&(0,x.f)(e?.data.name)===a);t&&i({x:d.P[t.id].positions?.x||0,y:d.P[t.id].positions?.y||0,width:d.P[t.id]?.width||0,height:d.P[t.id]?.height||0},{duration:1500})},[a,i,e,t]),null};var j=i(4684),C=i(3468);let P={y:50},T={x:200,y:200},S={character:({data:e})=>(0,a.jsx)(b.N,{href:`/characters/${e.slug}`,style:{opacity:0},children:(0,a.jsxs)("div",{className:p()["family-member-node"],children:[(0,a.jsx)("div",{className:p()["character-image-container"],children:(0,a.jsx)(s.A,{src:e?.image?.url,alt:e.name||"",className:"node-image",height:130,width:100})}),(0,a.jsx)("strong",{className:"node-label",children:e.name}),e?.occupation&&(0,a.jsx)("p",{className:"node-role",children:e.occupation}),(0,a.jsx)(r.h7,{type:"target",position:n.yX.Top,id:"target-top",style:{visibility:"hidden"}}),(0,a.jsx)(r.h7,{type:"target",position:n.yX.Left,id:"target-left",style:{visibility:"hidden"}}),(0,a.jsx)(r.h7,{type:"target",position:n.yX.Right,id:"target-right",style:{visibility:"hidden"}}),(0,a.jsx)(r.h7,{type:"target",position:n.yX.Bottom,id:"target-bottom",style:{visibility:"hidden"}}),(0,a.jsx)(r.h7,{type:"source",position:n.yX.Top,id:"source-top",style:{visibility:"hidden"}}),(0,a.jsx)(r.h7,{type:"source",position:n.yX.Left,id:"source-left",style:{visibility:"hidden"}}),(0,a.jsx)(r.h7,{type:"source",position:n.yX.Right,id:"source-right",style:{visibility:"hidden"}}),(0,a.jsx)(r.h7,{type:"source",position:n.yX.Bottom,id:"source-bottom",style:{visibility:"hidden"}})]})}),label:({data:e})=>{let{fitBounds:t,getNode:i}=(0,r.VH)();return(0,a.jsx)("div",{className:(0,c.A)(p()["label-node"]),onClick:()=>{let a=i(e.id)?.parentId;t({x:d.P[a]?.positions.x||0,y:d.P[a]?.positions.y||0,width:d.P[a]?.width||0,height:d.P[a]?.height||0},{duration:1500})},children:(0,a.jsx)("h1",{children:e.label?e.label.startsWith("The ")?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:p().the,children:"The"})," ",e.label.slice(4)]}):e.label:null})})},clan:({data:e})=>{let t=d.P[e.id],i=t?.width||600,n=t?.height||600;return(0,a.jsx)("div",{className:(0,c.A)(p()["clan-node"]),style:{width:i,height:n}})},clanLogo:function({data:e}){let t=d.P[e.id];if(!t||!e.clanSymbol?.url)return null;t.background.offset;let i=t.background.size||[t.width,t.height];return(0,a.jsx)("div",{className:p()["clan-logo-node"],style:{width:i[0],height:i[1]},children:(0,a.jsx)(_.A,{src:e.clanSymbol.url,alt:e.name||"Clan symbol",width:i[0],height:i[1],style:{width:i[0],height:i[1],objectFit:"contain"}})})}},R={TOP:n.yX.Top,BOTTOM:n.yX.Bottom,LEFT:n.yX.Left,RIGHT:n.yX.Right};function A({allFamilyClans:e}){let t=(0,o.useRef)(!1),i=(0,o.useRef)(null),f=(0,o.useRef)({x:0,y:0}),b=(0,g.d)(0),_=(0,g.d)(0),x=(0,o.useMemo)(()=>{let t=[],i=[];return e?.forEach(e=>{e.tree.length&&(t.push({id:e.id,position:{x:d.P[e.id]?.positions.x||0,y:d.P[e.id]?.positions.y||0},type:"clan",draggable:!1,zIndex:2,data:{...e}}),t.push({id:`${e.id}-logo`,position:{x:d.P[e.id]?.background.offset?.[0]||0,y:d.P[e.id]?.background.offset?.[1]||0},type:"clanLogo",data:{...e},parentId:e.id,expandParent:!0,connectable:!1,draggable:!1,selectable:!1}),e.tree.forEach(a=>{switch(a.__typename){case"FamilyTreeItemRecord":t.push({id:a.character?.id,position:{x:a.xCoord*T.x+P.y,y:a.yCoord*T.y+P.y},type:"character",parentId:e.id,expandParent:!0,connectable:!1,draggable:!1,zIndex:10,data:{...a.character}}),a.relation.length&&a.relation.forEach(e=>{let t=l[`${a.character?.id}-${e.relatedTo?.id}`],r=!e.showLine;i.push({id:`e${a.character?.id}-${e.relatedTo?.id}`,source:a.character?.id,target:e.relatedTo?.id,type:"step",label:e.relationTitle,zIndex:e?.relationTitle?9:1,labelStyle:{fill:"#9C8E7D",fontWeight:"bold",fontSize:14},labelBgStyle:{fill:"var(--neutralDarker)"},style:{stroke:e.showLine?"var(--edge-stroke-color)":"transparent"},...r?{sourcePosition:n.yX.Left,targetPosition:n.yX.Right,sourceHandle:"source-left",targetHandle:"target-right"}:t?{sourcePosition:R[t.sourcePosition]||n.yX.Bottom,targetPosition:R[t.targetPosition]||n.yX.Top,sourceHandle:`source-${t.sourcePosition.toLowerCase()}`,targetHandle:`target-${t.targetPosition.toLowerCase()}`}:{sourcePosition:n.yX.Bottom,targetPosition:n.yX.Top,sourceHandle:"source-bottom",targetHandle:"target-top"}})});break;case"FamilyTreeLabelRecord":t.push({id:a.id,position:{x:a.xCoord*T.x,y:a.yCoord*T.y},type:"label",parentId:e.id,expandParent:!0,connectable:!1,selectable:!1,draggable:!1,data:{...a}})}}))}),{nodes:t,edges:i}},[e]);return(0,o.useEffect)(()=>{function e(e){if(t.current)return;let i=(e.clientX/window.innerWidth-.5)*2,a=(e.clientY/window.innerHeight-.5)*2;f.current.x=50*i,f.current.y=50*a}let a=u.Gt.update(({delta:e})=>{if(!i.current)return;let t=e/1e3,a=(0,y.L2)(b.get(),-f.current.x,5,t),n=(0,y.L2)(_.get(),-f.current.y,5,t);b.set(a),_.set(n)},!0,!0);return window.addEventListener("mousemove",e),()=>{window.removeEventListener("mousemove",e),(0,u.WG)(a)}},[]),(0,a.jsxs)("div",{style:{overflow:"clip"},children:[(0,a.jsx)("div",{className:p().background,children:(0,a.jsx)(s.A,{src:"/images/backgrounds/familyTree.webp",alt:"Family tree background",width:4250,height:2390})}),(0,a.jsx)(h.P.div,{ref:i,style:{x:b,y:_},className:(0,c.A)(p().familyTreeContainer,"grid"),children:(0,a.jsxs)(r.Gc,{nodes:x.nodes,edges:x.edges,nodeTypes:S,fitView:!0,className:(0,c.A)(p().flowContainer),proOptions:{hideAttribution:!0},translateExtent:[[-500,-500],[3500,1500]],onNodeMouseEnter:(e,t)=>{"character"===t.type&&d.k.setState({hoveringCharacter:t.id,hoveringClan:t.parentId})},onNodeMouseLeave:(e,t)=>{"character"===t.type&&d.k.setState({hoveringCharacter:null,hoveringClan:null})},onInit:e=>{let t=e.getNodes().filter(e=>"character"===e.type).map(e=>document.querySelector(`[data-id='${e.id}'] > a`));(0,m.i)(t,{opacity:1,scale:[.8,1]},{duration:2,ease:j.lu,delay:(e,t)=>.15+(.03*e+Math.random())})},onMoveStart:()=>{f.current={x:0,y:0},t.current=!0},onMoveEnd:()=>{t.current=!1},children:[(0,a.jsx)(k,{nodes:x.nodes}),(0,a.jsx)(w,{})]})}),(0,a.jsx)(C.F,{})]})}var E=i(1426),L=i(1290),H=i(4413),N=i(6520),z=!0;function B({data:e,navigation:t}){let{allFamilyClans:i}=e;return(0,L.g)({sideless:!0}),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(H.A,{currentUrl:`${N.a.LINEAGES}`,pageTitle:"The Lineages | The Pendragon cycle | Rise of the Merlin",pageDescription:"Explore the rich family lineages of the Pendragon cycle - Rise of the Merlin, uncovering the connections of legendary clans.",image:"/images/lineages/lineages-thumbnail.jpg"}),(0,a.jsxs)("section",{className:"wrapper",children:[(0,a.jsx)(E.J,{leftMenuButton:"CLANS",rightMenuButton:"MAP",data:t}),(0,a.jsx)(A,{allFamilyClans:i})]})]})}},5678:(e,t,i)=>{"use strict";i.d(t,{P:()=>n,k:()=>a});let a=(0,i(1323).v)((e,t)=>({hoveringCharacter:null,hoveringClan:null})),n={fczwjM7pSDWkVlUjFIhgGQ:{ring:"caer_dyvi.webp",name:"Cymry of Caer Dyvi",sigil:"cymr_of_caer_dyvi.webp",frame:"cymry.webp",positions:{x:0,y:0},background:{image:"/images/clans/backgrounds/Cymry_of_Caer_Dyvi.jpg",offset:[150,-100],size:[600,600]},width:800,height:500},d2H6BJWoQzqOSpWBHQM12A:{ring:"avallach.webp",name:"Atlantean",sigil:"atlantean_of_avallach.webp",frame:"atlantean_goddeu.webp",positions:{x:1e3,y:0},background:{image:"/images/clans/backgrounds/Atlanteans_of_Goddeu.jpg",offset:[50,0],size:[500,500]},width:500,height:400},KlqUo7fbTWWctYSGZcSxwA:{ring:"roman_briton.webp",name:"The Roman Britons",sigil:"roman_britons.webp",frame:"briton_roman.webp",positions:{x:1700,y:500},background:{image:"/images/clans/backgrounds/Roman_Britons.jpg",offset:[0,0],size:[400,400]},width:400,height:450},"AGYoJnc9QESf_17a5CP-Jg":{ring:"atlantean.webp",name:"Atlantean: Goddeu",sigil:"atlantean_of_goddeu.webp",frame:"atlantean_goddeu.webp",positions:{x:700,y:550},background:{image:"/images/clans/backgrounds/Atlanteans_of_Goddeu.jpg",offset:[150,-50],size:[600,600]},width:800,height:450},Mz2WVJHeRaaq54aDXAiUrQ:{ring:"saecsens.webp",name:"Saecsens",sigil:"saecsens.webp",frame:"saecsens.webp",positions:{x:100,y:600},background:{image:"/images/clans/backgrounds/Saecsens.jpg",offset:[-100,-200],size:[600,600]},width:400,height:250},R5To2kYHRReAForya1sthw:{ring:"belgae.webp",name:"Belgae",sigil:"belgae.webp",frame:"belgae.webp",positions:{x:2300,y:0},background:{image:"/images/clans/backgrounds/Belgae.jpg",offset:[-150,-125],size:[500,500]},width:200,height:250},XBsQnbHgRkSWQx4JczJAIA:{ring:"cymry.webp",name:"The Cymry of Maridunum",sigil:"cymr_of_maridunum.webp",frame:"cymry.webp",positions:{x:2550,y:0},background:{image:"/images/clans/backgrounds/Cymry_of_Maridunum.jpg",offset:[0,100],size:[400,400]},width:400,height:650},DT58TyMzRvaz6xjVJiMBMQ:{ring:"briton.webp",name:"Britons of Dyfed (Vortigern)",sigil:"britons.webp",frame:"briton.webp",positions:{x:1800,y:0},background:{image:"/images/clans/backgrounds/Britons_of_Dyfed.jpg",offset:[-100,0],size:[400,400]},width:200,height:450},FbxZirW5Qrmvxa0PZXhDqg:{ring:"hill_folk.webp",name:"Hill Folk",sigil:"hill_folk.webp",frame:"hill_folk.webp",positions:{x:2600,y:700},background:{image:"/images/clans/backgrounds/Hill_Folk.jpg",offset:[-25,0],size:[250,250]},width:200,height:250},XzHrwbVGShilCuDfhVhTUw:{ring:"gaul.webp",name:"Missionaries from Gaul",sigil:"missionaries_from_gaul.webp",frame:"cymry.webp",positions:{x:2050,y:800},background:{image:"/images/clans/backgrounds/Missionaries_from_Gaul.jpg",offset:[20,-80],size:[400,400]},width:500,height:250},CHr2R5LtSDOUZafor6LH7g:{ring:"orcadians.webp",name:"Orcadian",sigil:"orcadian.webp",frame:"orcadian.webp",positions:{x:1300,y:200},background:{image:"/images/clans/backgrounds/Orcadians.jpg",offset:[75,75],size:[400,400]},width:400,height:450},WDjjAI8LQx2Pcki0_dS9CA:{ring:"cornovii.webp",name:"Cornovii",sigil:"cornovii.webp",frame:"cornovii.webp",positions:{x:2300,y:300},background:{image:"/images/clans/backgrounds/Cornovii.jpg",offset:[-100,0],size:[400,400]},width:200,height:400}}},6298:(e,t,i)=>{"use strict";i.d(t,{f:()=>a});let a=e=>e.toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]/g,"")},1109:e=>{e.exports={SmokeCanvas:"Smoke_SmokeCanvas__2YPsm"}},2863:e=>{e.exports={background:"familytree_background__JMdxP",familyTreeContainer:"familytree_familyTreeContainer__SyB33",flowContainer:"familytree_flowContainer__Q1feD","family-member-node":"familytree_family-member-node__E6fQv","character-image-container":"familytree_character-image-container__zIzDd","label-node":"familytree_label-node__ufq6J",the:"familytree_the__Be8KB","clan-logo-node":"familytree_clan-logo-node__D5EEq",controls:"familytree_controls__vIUEw",flowBackground:"familytree_flowBackground__Llvsy",edgeLabel:"familytree_edgeLabel__kA_HQ",edgeDefault:"familytree_edgeDefault__JlptC",edgeConnected:"familytree_edgeConnected__q4O2S",drawLine:"familytree_drawLine__dgdWQ",edgeReconnected:"familytree_edgeReconnected__kLskv",edgeHidden:"familytree_edgeHidden__AL08e",SmokeCanvas:"familytree_SmokeCanvas__3vHSt"}}},e=>{var t=t=>e(e.s=t);e.O(0,[845,52,544,951,153,636,593,792],()=>t(7383)),_N_E=e.O()}]);